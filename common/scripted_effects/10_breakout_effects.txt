breed_ratio_modifier_check = {
	every_scope_state = {
		save_scope_as = checked_state
		#计算劳动力再生产能力
		set_variable = {
			name = breed_power
			value = 0
		}
		set_variable = {
			name = breed_quality
			value = 0
		}
		every_scope_building = {
			limit = {
				OR = { #自给农业
					is_building_type = building_subsistence_farms
					is_building_type = building_subsistence_orchards
					is_building_type = building_subsistence_pastures
				}
			}
			if = {
				limit = { 
					OR = { #农奴制
						has_active_production_method = pm_serfdom 
						has_active_production_method = pm_serfdom_building_subsistence_pastures
					}
				}
				scope:checked_state = {
					change_variable = {
						name = breed_power
						add = {
							value = 24000 #农奴制一级提供24000再生产
							multiply = PREV.occupancy
							multiply = PREV.level
						}
					}
				}
			}
			else = {
				scope:checked_state = {
					change_variable = {
						name = breed_power
						add = {
							value = 20000 #自耕农一级提供20000再生产
							multiply = PREV.occupancy
							multiply = PREV.level
						}
					}
					change_variable = {
						name = breed_quality
						add = {
							value = 1000 #自耕农一级提供1000质量
							multiply = PREV.occupancy
							multiply = PREV.level
						}
					}
				}
			}
		}
		every_scope_building = {
			limit = {
				OR = { #居民区
					is_building_type = breed_center
				}
			}
			if = {
				limit = { has_active_production_method = pm_tradition_breeder } #多子多福
				scope:checked_state = {
					change_variable = {
						name = breed_power
						add = {
							value = 14000 #多子多福一级提供14000
							multiply = PREV.occupancy
							multiply = PREV.level
						}
					}
					change_variable = {
						name = breed_quality
						add = {
							value = 4200 #多子多福一级提供4200质量
							multiply = PREV.occupancy
							multiply = PREV.level
						}
					}
				}
			}
			else = {
				scope:checked_state = {
					change_variable = {
						name = breed_power
						add = {
							value = 10000 #优生优育一级提供10000
							multiply = PREV.occupancy
							multiply = PREV.level
						}
					}
					change_variable = {
						name = breed_quality
						add = {
							value = 5000 #优生优育一级提供5000质量
							multiply = PREV.occupancy
							multiply = PREV.level
						}
					}
				}
			}
		}
		
		#计算劳动力再生产能力
		set_variable = {
			name = breed_ratio
			value = var:breed_power
		}
		
		change_variable = {
			name = breed_ratio
			divide = {
				value = state_population
				min = 1
			}
		}
		#清除旧有buff
		# if = {
			# limit = { has_modifier = breed_ratio_modifier_00 }
			# remove_modifier = breed_ratio_modifier_00
		# }
		# else_if = {
			# limit = { has_modifier = breed_ratio_modifier_05 }
			# remove_modifier = breed_ratio_modifier_05
		# }
		# else_if = {
			# limit = { has_modifier = breed_ratio_modifier_10 }
			# remove_modifier = breed_ratio_modifier_10
		# }
		# else_if = {
			# limit = { has_modifier = breed_ratio_modifier_15 }
			# remove_modifier = breed_ratio_modifier_15
		# }
		# else_if = {
			# limit = { has_modifier = breed_ratio_modifier_20 }
			# remove_modifier = breed_ratio_modifier_20
		# }
		# else_if = {
			# limit = { has_modifier = breed_ratio_modifier_25 }
			# remove_modifier = breed_ratio_modifier_25
		# }
		# else_if = {
			# limit = { has_modifier = breed_ratio_modifier_30 }
			# remove_modifier = breed_ratio_modifier_30
		# }
		# else_if = {
			# limit = { has_modifier = breed_ratio_modifier_35 }
			# remove_modifier = breed_ratio_modifier_35
		# }
		# else_if = {
			# limit = { has_modifier = breed_ratio_modifier_40 }
			# remove_modifier = breed_ratio_modifier_40
		# }
		# else_if = {
			# limit = { has_modifier = breed_ratio_modifier_45 }
			# remove_modifier = breed_ratio_modifier_45
		# }
		# else_if = {
			# limit = { has_modifier = breed_ratio_modifier_50 }
			# remove_modifier = breed_ratio_modifier_50
		# }
		# else_if = {
			# limit = { has_modifier = breed_ratio_modifier_55 }
			# remove_modifier = breed_ratio_modifier_55
		# }
		# else_if = {
			# limit = { has_modifier = breed_ratio_modifier_60 }
			# remove_modifier = breed_ratio_modifier_60
		# }
		# else_if = {
			# limit = { has_modifier = breed_ratio_modifier_65 }
			# remove_modifier = breed_ratio_modifier_65
		# }
		# else_if = {
			# limit = { has_modifier = breed_ratio_modifier_70 }
			# remove_modifier = breed_ratio_modifier_70
		# }
		# else_if = {
			# limit = { has_modifier = breed_ratio_modifier_75 }
			# remove_modifier = breed_ratio_modifier_75
		# }
		#按照比例决定生育率buff
		if = {
			limit = {
				var:breed_ratio <= 0.2
			}
			if ={
				limit = {
					var:breed_ratio <= 0.1
				}
				if ={
					limit = {
						var:breed_ratio <= 0.05
					}
					add_modifier = {
						name = breed_ratio_modifier_00
						months = 1
					}
				}
				else = {
					add_modifier = {
						name = breed_ratio_modifier_05
						months = 1
					}
				}
			}	
			else ={
				if ={
					limit = {
						var:breed_ratio <= 0.15
					}
					add_modifier = {
						name = breed_ratio_modifier_10
						months = 1
					}
				}
				else = {
					add_modifier = {
						name = breed_ratio_modifier_15
						months = 1
					}
				}
			}	
		}
		else_if = {
			limit = {
				var:breed_ratio <= 0.4
			}
			if ={
				limit = {
					var:breed_ratio <= 0.3
				}
				if ={
					limit = {
						var:breed_ratio <= 0.25
					}
					add_modifier = {
						name = breed_ratio_modifier_20
						months = 1
					}
				}
				else = {
					add_modifier = {
						name = breed_ratio_modifier_25
						months = 1
					}
				}
			}	
			else ={
				if ={
					limit = {
						var:breed_ratio <= 0.35
					}
					add_modifier = {
						name = breed_ratio_modifier_30
						months = 1
					}
				}
				else = {
					add_modifier = {
						name = breed_ratio_modifier_35
						months = 1
					}
				}
			}	
		}
		else_if = {
			limit = {
				var:breed_ratio <= 0.6
			}
			if ={
				limit = {
					var:breed_ratio <= 0.5
				}
				if ={
					limit = {
						var:breed_ratio <= 0.45
					}
					add_modifier = {
						name = breed_ratio_modifier_40
						months = 1
					}
				}
				else = {
					add_modifier = {
						name = breed_ratio_modifier_45
						months = 1
					}
				}
			}	
			else ={
				if ={
					limit = {
						var:breed_ratio <= 0.55
					}
					add_modifier = {
						name = breed_ratio_modifier_50
						months = 1
					}
				}
				else = {
					add_modifier = {
						name = breed_ratio_modifier_55
						months = 1
					}
				}
			}
		}
		else = {
			if ={
				limit = {
					var:breed_ratio <= 0.65
				}
				add_modifier = {
					name = breed_ratio_modifier_60
					months = 1
				}
			}	
			else_if ={
				limit = {
					var:breed_ratio <= 0.70
				}
				add_modifier = {
					name = breed_ratio_modifier_65
					months = 1
				}
			}	
			else_if ={
				limit = {
					var:breed_ratio <= 0.75
				}
				add_modifier = {
					name = breed_ratio_modifier_70
					months = 1
				}
			}	
			else ={
				add_modifier = {
					name = breed_ratio_modifier_75
					months = 1
				}
			}
		}
		
		#计算基础受教育机会
		set_variable = {
			name = base_education_access
			value = var:breed_quality
		}
		change_variable = {
			name = base_education_access
			divide = {
				value = var:breed_power
				min = 1
			}
		}
		#清除旧有buff
		# if = {
			# limit = { has_modifier = base_education_access_modifier_00 }
			# remove_modifier = base_education_access_modifier_00
		# }
		# else_if = {
			# limit = { has_modifier = base_education_access_modifier_05 }
			# remove_modifier = base_education_access_modifier_05
		# }
		# else_if = {
			# limit = { has_modifier = base_education_access_modifier_10 }
			# remove_modifier = base_education_access_modifier_10
		# }
		# else_if = {
			# limit = { has_modifier = base_education_access_modifier_15 }
			# remove_modifier = base_education_access_modifier_15
		# }
		# else_if = {
			# limit = { has_modifier = base_education_access_modifier_20 }
			# remove_modifier = base_education_access_modifier_20
		# }
		# else_if = {
			# limit = { has_modifier = base_education_access_modifier_25 }
			# remove_modifier = base_education_access_modifier_25
		# }
		# else_if = {
			# limit = { has_modifier = base_education_access_modifier_30 }
			# remove_modifier = base_education_access_modifier_30
		# }
		# else_if = {
			# limit = { has_modifier = base_education_access_modifier_35 }
			# remove_modifier = base_education_access_modifier_35
		# }
		# else_if = {
			# limit = { has_modifier = base_education_access_modifier_40 }
			# remove_modifier = base_education_access_modifier_40
		# }
		# else_if = {
			# limit = { has_modifier = base_education_access_modifier_45 }
			# remove_modifier = base_education_access_modifier_45
		# }
		# else_if = {
			# limit = { has_modifier = base_education_access_modifier_50 }
			# remove_modifier = base_education_access_modifier_50
		# }
		#按照比例决定受教育机会buff
		if = {
			limit = {
				var:base_education_access <= 0.2
			}
			if ={
				limit = {
					var:base_education_access <= 0.1
				}
				if ={
					limit = {
						var:base_education_access <= 0.05
					}
					add_modifier = {
						name = base_education_access_modifier_00
						months = 1
					}
				}
				else = {
					add_modifier = {
						name = base_education_access_modifier_05
						months = 1
					}
				}
			}	
			else ={
				if ={
					limit = {
						var:base_education_access <= 0.15
					}
					add_modifier = {
						name = base_education_access_modifier_10
						months = 1
					}
				}
				else = {
					add_modifier = {
						name = base_education_access_modifier_15
						months = 1
					}
				}
			}	
		}
		else_if = {
			limit = {
				var:base_education_access <= 0.4
			}
			if ={
				limit = {
					var:base_education_access <= 0.3
				}
				if ={
					limit = {
						var:base_education_access <= 0.25
					}
					add_modifier = {
						name = base_education_access_modifier_20
						months = 1
					}
				}
				else = {
					add_modifier = {
						name = base_education_access_modifier_25
						months = 1
					}
				}
			}	
			else ={
				if ={
					limit = {
						var:base_education_access <= 0.35
					}
					add_modifier = {
						name = base_education_access_modifier_30
						months = 1
					}
				}
				else = {
					add_modifier = {
						name = base_education_access_modifier_35
						months = 1
					}
				}
			}	
		}
		else_if = {
			limit = {
				var:base_education_access <= 0.5
			}
			if ={
				limit = {
					var:base_education_access <= 0.45
				}
				add_modifier = {
					name = base_education_access_modifier_40
					months = 1
				}
			}
			else = {
				add_modifier = {
					name = base_education_access_modifier_45
					months = 1
				}
			}
		}
		else = {
			add_modifier = {
				name = base_education_access_modifier_50
				months = 1
			}
		}
	}
}
